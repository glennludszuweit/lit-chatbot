{"version":3,"file":"chat-controller.js","sourceRoot":"","sources":["../../../src/assets/js/controllers/chat-controller.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * @description Handles generating and interacting with the chat window\n */\nclass ChatController {\n  constructor() {\n    this.activeForm = {};\n    this.dateCounter = 1;\n    this.datePicker = null;\n    this.dateClass = '';\n\n    this.context = null;\n    this.processor = null;\n    this.input = null;\n\n    this.sttClient = null;\n    this.ttsClient = null;\n\n    this.SESSION_ENUM = {\n      DETECTED_LANGUAGE: 'detectedLanguage',\n    };\n  }\n\n  init() {\n    this.masterBotId = window.chatSettings.masterBotID;\n\n    // workout the stt and tts endpoint\n    if (window.location.hostname === 'localhost') {\n      this.sttEndpoint = 'ws://localhost:8082';\n      this.ttsEndpoint = 'ws://localhost:8083';\n    } else {\n      this.sttEndpoint = `wss://${window.location.hostname}/backend-stt`;\n      this.ttsEndpoint = `wss://${window.location.hostname}/backend-tts`;\n    }\n\n    // reconnects socket and persists chat messages\n    window.addEventListener('focus', () => {\n      // reconnect to the web socket server\n      socketController.resetConversation({\n        resetButtonClicked: false,\n        keepChatMsgs: true,\n      });\n    });\n  }\n\n  /**\n   * @description - Scrolls to the bottom of the chat window\n   */\n  scrollToBottom() {\n    const lastMessage =\n      this.shadowRootDoc.querySelector('#chat-messages').lastChild;\n    if (lastMessage) {\n      const isSafari =\n        navigator.vendor &&\n        navigator.vendor.indexOf('Apple') > -1 &&\n        navigator.userAgent &&\n        navigator.userAgent.indexOf('CriOS') == -1 &&\n        navigator.userAgent.indexOf('FxiOS') == -1;\n\n      if (isSafari) {\n        lastMessage.parentNode.scrollTop = lastMessage.offsetTop - 50;\n      } else {\n        lastMessage.scrollIntoView({behavior: 'smooth'});\n      }\n      lastMessage.scrollIntoView({behavior: 'smooth'});\n    }\n  }\n\n  /**\n   * @description toggles the typing indicator to appear\n   */\n  showTypingIndicator() {\n    const chatMessageWindow =\n      this.shadowRootDoc.querySelector('#chat-messages');\n    chatMessageWindow.appendChild(this.typingIndicator);\n    this.scrollToBottom();\n  }\n\n  /**\n   * @description hides the typing indicator\n   */\n  hideTypingIndicator() {\n    const typingIndicator =\n      this.shadowRootDoc.querySelector('#typing-indicator');\n    if (typingIndicator) {\n      const chatMessageWindow =\n        this.shadowRootDoc.querySelector('#chat-messages');\n      chatMessageWindow.removeChild(typingIndicator);\n    }\n  }\n\n  /**\n   * @description formatting date according to tale.dateTime package\n   * @param {Object} date - Date() value\n   */\n\n  formatDate(date, range) {\n    date = date.split('-');\n    if (range) {\n      date = date[1] + ' ' + date[0] + ', ' + date[2] + ' 00:00:00';\n      return date;\n    } else {\n      const chart = {\n        Jan: 0,\n        Feb: 1,\n        Mar: 2,\n        Apr: 3,\n        May: 4,\n        June: 5,\n        July: 6,\n        Aug: 7,\n        Sep: 8,\n        Oct: 9,\n        Nov: 10,\n        Dec: 11,\n      };\n      date = [chart[date[1]], parseInt(date[2])];\n      return date;\n    }\n  }\n\n  /**\n   * @description Set date picker options\n   * @param {Object} data - response config datepicker data\n   */\n\n  setDateOptions(data) {\n    let dateOptions = {};\n    let options = {\n      startOpen: true,\n      stayOpen: true,\n      timeFormat: false,\n      dateBlacklist: false,\n      closeButton: false,\n      dateFormat: 'dd/mm/YYYY',\n      classNames: 'tail-date-container',\n      locale: 'de',\n    };\n\n    var range = {};\n    var pastDate = new Date();\n    pastDate.setDate(pastDate.getDate() - 1);\n    var futureDate = new Date();\n    futureDate.setDate(futureDate.getDate() + 1);\n    // apply response settings to the datepicker\n\n    if (data.allowFutureDates && !data.allowPastDates) {\n      range.start = futureDate;\n      range.end = new Date(8640000000000000);\n      dateOptions.dateType = 'future';\n    } else if (data.allowPastDates && !data.allowFutureDates) {\n      range.start = new Date('1000,1,1');\n      range.end = pastDate;\n      dateOptions.dateType = 'past';\n    } else if (data.minDate && data.maxDate) {\n      range.start = new Date(this.formatDate(data.minDate, true));\n      range.end = new Date(this.formatDate(data.maxDate, true));\n      dateOptions.dateType = 'range';\n      dateOptions.maxDate = data.maxDate;\n    } else {\n      range.start = new Date('1000,1,1');\n      range.end = new Date(8640000000000000);\n    }\n\n    var dateRange = [range];\n    options.dateRanges = dateRange;\n    dateOptions.options = options;\n    return dateOptions;\n  }\n\n  /**\n   * @description Creates an HTML element\n   * @param {Object} type - HTML element type, defaults to div\n   * @param {Object} params - HTML element parameters\n   */\n  createElement(type, params) {\n    const elem = document.createElement(type || 'div');\n    if (params) {\n      if (params.className) elem.className = params.className;\n      if (params.id) elem.id = params.id;\n      if (params.innerText) elem.innerText = params.innerText;\n      if (params.innerHTML) elem.innerHTML = params.innerHTML;\n      if (params.onclick && typeof params.onclick === 'string')\n        elem.setAttribute('onclick', params.onclick);\n      else if (params.onclick) elem.onclick = params.onclick;\n      if (params.onsubmit && typeof params.onsubmit === 'string')\n        elem.setAttribute('onsubmit', params.onsubmit);\n      else if (params.onsubmit) elem.onsubmit = params.onsubmit;\n      if (params.oninput && typeof params.oninput === 'string')\n        elem.setAttribute('oninput', params.oninput);\n      else if (params.oninput) elem.oninput = params.oninput;\n      if (params.rel) elem.setAttribute('rel', params.rel);\n      if (params.href) elem.setAttribute('href', params.href);\n      if (params.src) elem.setAttribute('src', params.src);\n      if (params.type) elem.setAttribute('type', params.type);\n      if (params.autocomplete)\n        elem.setAttribute('autocomplete', params.autocomplete);\n      if (params['data-value'])\n        elem.setAttribute('data-value', params['data-value']);\n      if (params.onchange) elem.onchange = params.onchange;\n    }\n    return elem;\n  }\n\n  /**\n   * @description Create message elements\n   * @param {HTMLElement} messageContainer - container to add new elements to\n   * @param {Array<String>} messages - array of messages to add\n   * @param {Object} content - response content\n   */\n  addMessages(messageContainer, messages, content) {\n    let regex2 = /<DB>/;\n\n    if (regex2.test(messages)) {\n      if (this.prevElement != null) {\n        const carouselContainer = this.prevElement.children[0].children[0];\n        const carouselElem = this.createElement('div', {\n          className: 'carousel-option',\n        });\n        const carouselTextDiv = this.createElement('div', {\n          className: 'carouselTitleDiv',\n        });\n        const carouselText = this.createElement('span', {\n          innerHTML: messages[0],\n          className: 'carouselTitle',\n        });\n        carouselElem.appendChild(carouselTextDiv);\n        carouselTextDiv.appendChild(carouselText);\n        carouselContainer.appendChild(carouselElem);\n      } else {\n        const carouselContainer = this.createElement('div', {\n          className: 'carousel-container',\n        });\n        const scrollContainer = this.createElement('div', {\n          className: 'scroll-container',\n        });\n        const carouselElem = this.createElement('div', {\n          className: 'carousel-option',\n        });\n        const carouselTextDiv = this.createElement('div', {\n          className: 'carouselTitleDiv',\n        });\n        const carouselText = this.createElement('span', {\n          innerHTML: messages[0],\n          className: 'carouselTitle',\n        });\n        carouselElem.appendChild(carouselTextDiv);\n        carouselTextDiv.appendChild(carouselText);\n        carouselContainer.appendChild(carouselElem);\n        scrollContainer.appendChild(carouselContainer);\n        messageContainer.appendChild(scrollContainer);\n        this.prevElement = messageContainer;\n      }\n    } else {\n      this.prevElement = null;\n      for (let i = 0; i < messages.length; i++) {\n        const messageElem = this.createElement('div', {\n          className: 'message',\n          innerHTML: messages[i],\n        });\n        messageContainer.appendChild(messageElem);\n\n        // added timestamp\n        chatController.addTimeStamp(messageElem);\n      }\n    }\n\n    messageContainer.setAttribute('data-ssml', content.responseSsml);\n  }\n\n  /**\n   * @description Create button elements\n   * @param {HTMLElement} messageContainer - container to add new elements to\n   * @param {Array<String>} buttons - array of buttons to add\n   */\n  addButtons(messageContainer, buttons) {\n    const buttonContainer = this.createElement('div', {\n      className: 'button-container',\n    });\n\n    for (let b = 0; b < buttons.length; b++) {\n      if (\n        buttons[b]['name'] &&\n        (!buttons[b]['value'] || buttons[b]['value'] === '')\n      ) {\n        buttons[b]['value'] = buttons[b]['name'];\n      }\n\n      // if buttons contain a link, create element for open link button\n      if (buttons[b] && buttons[b]['link']) {\n        const buttonElem = this.createElement('button', {\n          className: 'convButton',\n          innerText: buttons[b].name,\n          onclick:\n            'chatController.openButtonLink(' +\n            JSON.stringify(buttons[b].link) +\n            ')',\n        });\n        const openLinkElem = this.createElement('div', {\n          className: 'openLinkButton',\n        });\n\n        buttonElem.appendChild(openLinkElem);\n        buttonContainer.appendChild(buttonElem);\n      } else {\n        const buttonElem = this.createElement('button', {\n          className: 'convButton',\n          innerText: buttons[b].name,\n          onclick:\n            'chatController.sendQuickReply(this, ' +\n            JSON.stringify(buttons[b].name) +\n            ')',\n        });\n\n        buttonContainer.appendChild(buttonElem);\n      }\n    }\n    messageContainer.appendChild(buttonContainer);\n\n    // added timestamp\n    chatController.addTimeStamp(buttonContainer);\n  }\n\n  /**\n   * @description Create carousel elements\n   * @param {HTMLElement} messageContainer - container to add new elements to\n   * @param {Array<String>} carousel - array of carousel items to add\n   * @param {boolean} displayUnselectedOptions - whether carousel slides should be displayed also after selection\n   * @param {boolean} hideButtons - is true if carousel response is not the last message in a chat flow\n   */\n  addCarousel(\n    messageContainer,\n    carousel,\n    displayUnselectedOptions,\n    hideButtons\n  ) {\n    // do not create already used carousel slides if they shouldn't been displayed\n    if (hideButtons && !displayUnselectedOptions) return;\n\n    const carouselContainer = this.createElement('div', {\n      className: 'carousel-container',\n    });\n    const scrollContainer = this.createElement('div', {\n      className: 'scroll-container',\n    });\n    for (let x = 0; x < carousel.length; x++) {\n      const carouselElem = this.createElement('div', {\n        className: 'carousel-option' + (hideButtons ? ' disabled' : ''),\n        onclick: () => {\n          // don't bind onclick event to already used slides\n          if (hideButtons) return null;\n          // if unselected slides should be visible, then delete onclick logic when any slide is clicked and change cursor to the default one\n          if (displayUnselectedOptions) {\n            carouselContainer\n              .querySelectorAll('.carousel-option')\n              .forEach((item) => {\n                item.onclick = null;\n                item.classList.add('disabled');\n              });\n            this.sendQuickReply(null, carousel[x].title);\n          } else {\n            this.sendQuickReply(carouselContainer, carousel[x].title);\n          }\n        },\n      });\n      const carouselImg = this.createElement('img', {\n        src: carousel[x].url,\n      });\n      const carouselTextDiv = this.createElement('div', {\n        className: 'carouselTitleDiv',\n      });\n      const carouselText = this.createElement('span', {\n        innerText: carousel[x].title,\n        className: 'carouselTitle',\n      });\n      const carouselSubTitleDiv = this.createElement('div', {\n        className: 'carouselSubTitleDiv',\n      });\n      const carouselSubTitle = this.createElement('span', {\n        innerText: carousel[x].subTitle,\n        className: 'carouselSubTitle',\n      });\n      const carouselImageContainer = this.createElement('div', {\n        className: 'carousel-image-container',\n      });\n      carouselImageContainer.appendChild(carouselImg);\n      carouselElem.appendChild(carouselImageContainer);\n      carouselElem.appendChild(carouselTextDiv);\n      carouselTextDiv.appendChild(carouselText);\n      carouselElem.appendChild(carouselSubTitleDiv);\n      carouselSubTitleDiv.appendChild(carouselSubTitle);\n      carouselContainer.appendChild(carouselElem);\n    }\n    scrollContainer.appendChild(carouselContainer);\n    messageContainer.appendChild(scrollContainer);\n\n    // added timestamp\n    chatController.addTimeStamp(scrollContainer);\n  }\n\n  /**\n   * @description Create button elements\n   * @param {HTMLElement} messageContainer - container to add new elements to\n   * @param {Array<String>} feedbackTiles - array of feedback tiles to add\n   */\n  addFeedbackTiles(messageContainer, feedbackTiles) {\n    const tileContainer = this.createElement('div', {\n      className: 'feedback-button-container',\n    });\n    for (let t = 0; t < feedbackTiles.length; t++) {\n      const tileElem = this.createElement('button', {\n        className: 'convButton',\n        innerHTML:\n          '<img style=\"float:left\"  src=\"' +\n          feedbackTiles[t].image +\n          '\"/><span style=\"vertical-align: -webkit-baseline-middle;\">' +\n          feedbackTiles[t].name +\n          '</span>',\n        onclick:\n          \"chatController.sendQuickReply(this, '\" +\n          feedbackTiles[t].name +\n          \"')\",\n      });\n\n      tileContainer.appendChild(tileElem);\n    }\n\n    messageContainer.appendChild(tileContainer);\n\n    // added timestamp\n    chatController.addTimeStamp(tileContainer);\n  }\n\n  /**\n   * @description Create datepicker element\n   * @param {HTMLElement} messageContainer - container to add new elements to\n   * @param {Object} data - data of datepicker to add\n   */\n  addDatepicker(messageContainer, data) {\n    chatController.dateClass = 'datepicker-' + chatController.dateCounter;\n    // create necessary HTML elements\n    const datepickerContainer = this.createElement('div', {\n      className: chatController.dateClass,\n    });\n    const datepickerElemContainer = this.createElement('div', {\n      className: 'datepicker-element-container',\n    });\n    datepickerContainer.appendChild(datepickerElemContainer);\n    // add the HTML elements to the message container\n    messageContainer.appendChild(datepickerContainer);\n    const dateOptions = this.setDateOptions(data);\n    var monthRange = null;\n    if (dateOptions.dateType === 'range') {\n      monthRange = this.formatDate(dateOptions.maxDate, false);\n    }\n    setTimeout(function () {\n      chatController.datePicker = new tail.DateTime(\n        '.' + chatController.dateClass,\n        dateOptions.options\n      );\n      if (dateOptions.dateType === 'range') {\n        chatController.datePicker.switchMonth(monthRange[0], monthRange[1]);\n      }\n      if (chatController.datePicker.length > 1) {\n        chatController.datePicker.forEach(() => {\n          chatController.dateCounter += 1;\n        });\n      } else {\n        chatController.datePicker.on('change', function () {\n          var data = document.getElementsByClassName(\n            chatController.dateClass\n          )[0].value;\n          // chatController.datePicker.close();\n          document.getElementById('user-input').value = data;\n          document.getElementById('user-input').focus();\n        });\n        datepickerElemContainer.appendChild(\n          document.getElementById('tail-datetime-' + chatController.dateCounter)\n        );\n        chatController.scrollToBottom();\n        chatController.dateCounter += 1;\n      }\n    }, 0);\n\n    // added timestamp\n    chatController.addTimeStamp(datepickerContainer);\n  }\n\n  /**\n   * @description Updates form value\n   * @param  fieldName - field name\n   * @param  value - new value\n   * @param  elem - field element\n   */\n  updateFormValue(fieldName, value, elem) {\n    this.activeForm[fieldName] = value;\n    elem.classList.remove('error');\n    const errorField = elem.querySelector('#field-error');\n    if (errorField) errorField.classList.remove('show');\n  }\n\n  /**\n   * @description Create form element\n   * @param {HTMLElement} messageContainer - container to add new element to\n   * @param {Array<String>} carousel - array of carousel items to add\n   */\n  addForm(messageContainer, form, buttons) {\n    this.activeForm = {};\n    const formContainer = this.createElement('div', {\n      className: 'form-container',\n    });\n\n    for (let x = 0; x < form.data.length; x++) {\n      const fieldData = form.data[x];\n      const fieldContainer = this.createElement('div', {\n        className: 'field-container ' + fieldData.type,\n        'data-value': fieldData.title,\n      });\n      if (fieldData.type !== 'checkbox') {\n        const fieldLabel = this.createElement('div', {\n          className: 'field-label',\n          innerText: fieldData.title + (fieldData.required ? '*' : ''),\n        });\n        fieldContainer.appendChild(fieldLabel);\n      }\n\n      if (fieldData.type === 'text') {\n        const fieldInput = this.createElement('input', {\n          className: 'field-input text',\n          type: 'text',\n          oninput:\n            \"chatController.updateFormValue('\" +\n            fieldData.title +\n            \"', this.value, this.parentNode)\",\n        });\n        fieldContainer.appendChild(fieldInput);\n      }\n\n      if (fieldData.type === 'textarea') {\n        const fieldInput = this.createElement('textarea', {\n          className: 'field-input textarea',\n          oninput:\n            \"chatController.updateFormValue('\" +\n            fieldData.title +\n            \"', this.value, this.parentNode)\",\n        });\n        fieldContainer.appendChild(fieldInput);\n      }\n\n      if (fieldData.type === 'password') {\n        const fieldInput = this.createElement('input', {\n          className: 'field-input password',\n          type: 'password',\n          autocomplete: 'new-password',\n          oninput:\n            \"chatController.updateFormValue('\" +\n            fieldData.title +\n            \"', this.value, this.parentNode)\",\n        });\n        fieldContainer.appendChild(fieldInput);\n      }\n\n      if (\n        fieldData.type === 'text' ||\n        fieldData.type === 'textarea' ||\n        fieldData.type === 'password'\n      ) {\n        const fieldError = this.createElement('div', {\n          id: 'field-error',\n          innerText: fieldData.errorMessage,\n        });\n        fieldContainer.appendChild(fieldError);\n      }\n\n      if (fieldData.type === 'dropdown' && fieldData.dropdownValues) {\n        const dropdown = this.createElement('div', {\n          className: 'dropdown-input placeholder',\n          onclick: (e) => {\n            if (\n              e.target.classList.contains('dropdown-input') ||\n              e.target.classList.contains('dropdown-label')\n            ) {\n              const dropdownElem = e.target.classList.contains('dropdown-input')\n                ? e.target\n                : e.target.parentNode;\n              dropdownElem\n                .querySelector('.dropdown-values-container')\n                .classList.toggle('hidden');\n            }\n          },\n        });\n        const dropdownLabel = this.createElement('span', {\n          className: 'dropdown-label',\n          innerText: 'Select option',\n        });\n        dropdown.appendChild(dropdownLabel);\n\n        const dropdownContainer = this.createElement('div', {\n          className: 'dropdown-values-container hidden',\n        });\n\n        for (let i = 0; i < fieldData.dropdownValues.length; i++) {\n          const option = this.createElement('div', {\n            className: 'dropdown-value',\n            'data-value':\n              fieldData.dropdownValues[i].value ||\n              fieldData.dropdownValues[i][fieldData.variableValue],\n            innerText:\n              fieldData.dropdownValues[i].value ||\n              fieldData.dropdownValues[i][fieldData.variableName],\n            onclick: (e) => {\n              e.target.parentNode.parentNode.querySelector('span').innerText =\n                e.target.innerText;\n              e.target.parentNode.parentNode.classList.remove('placeholder');\n              e.target.parentNode.classList.add('hidden');\n              chatController.updateFormValue(\n                fieldData.title,\n                e.target.dataset.value,\n                e.target.parentNode.parentNode.parentNode\n              );\n            },\n          });\n          dropdownContainer.appendChild(option);\n        }\n        dropdown.appendChild(dropdownContainer);\n        fieldContainer.appendChild(dropdown);\n      }\n\n      if (fieldData.type === 'radioButtons') {\n        const buttonsContainer = this.createElement('div', {\n          className: 'form-buttons-container',\n        });\n\n        for (let i = 0; i < fieldData.radioValues.length; i++) {\n          const button = this.createElement('div', {\n            className: 'form-button',\n            innerText: fieldData.radioValues[i].value,\n            'data-value': fieldData.radioValues[i].key,\n            onclick: (e) => {\n              if (fieldData.allowMultiple) {\n                e.target.classList.toggle('active');\n              } else {\n                e.target.classList.toggle('active');\n\n                e.target.parentNode\n                  .querySelectorAll('.form-button')\n                  .forEach((item) => {\n                    if (e.target.classList !== item.classList) {\n                      item.classList.remove('active');\n                    }\n                  });\n              }\n              const values = [];\n              e.target.parentNode\n                .querySelectorAll('.active')\n                .forEach((item) => values.push(item.dataset.value));\n\n              chatController.updateFormValue(\n                fieldData.title,\n                values,\n                e.target.parentNode.parentNode\n              );\n            },\n          });\n          buttonsContainer.appendChild(button);\n        }\n        fieldContainer.appendChild(buttonsContainer);\n      }\n\n      if (fieldData.type === 'checkbox') {\n        const checkboxContainer = this.createElement('div', {\n          className: 'checkbox-container',\n        });\n\n        const checkbox = this.createElement('input', {\n          type: 'checkbox',\n          onchange: (e) => {\n            const value = e.target.checked;\n            if (value) {\n              e.target.parentNode.classList.add('checked');\n            } else {\n              e.target.parentNode.classList.remove('checked');\n            }\n            chatController.updateFormValue(\n              fieldData.title,\n              value,\n              e.target.parentNode.parentNode.parentNode\n            );\n          },\n        });\n        const label = this.createElement('label');\n        label.appendChild(checkbox);\n        checkboxContainer.appendChild(label);\n\n        const span = this.createElement('span', {\n          className: 'field-label',\n          innerHTML: fieldData.title,\n        });\n        checkboxContainer.appendChild(span);\n        fieldContainer.appendChild(checkboxContainer);\n      }\n\n      formContainer.appendChild(fieldContainer);\n    }\n\n    const responseButtonsContainer = this.createElement('div', {\n      className: 'form-response-buttons-container',\n    });\n\n    for (let b = 0; b < buttons.length; b++) {\n      let clickAction;\n      if (buttons[b].name) {\n        clickAction = (e) => {\n          const errorFields = form.data\n            .filter((item) => {\n              Array.isArray(this.activeForm[item.title])\n                ? this.activeForm[item.title].length <= 0\n                  ? (this.activeForm[item.title] = undefined)\n                  : this.activeForm[item.title]\n                : this.activeForm[item.title];\n              return item.required && !this.activeForm[item.title];\n            })\n            .map((item) => item.title);\n\n          const invalidFields = form.data\n            .filter(\n              (item) =>\n                item.validation &&\n                this.activeForm[item.title] &&\n                new RegExp(item.regexpPattern, item.regexpFlags.join('')).test(\n                  this.activeForm[item.title]\n                ) === false\n            )\n            .map((item) => item.title);\n\n          if (errorFields.length > 0) {\n            e.target.parentNode.parentNode\n              .querySelectorAll('.field-container')\n              .forEach((item) => {\n                if (errorFields.indexOf(item.dataset.value) !== -1)\n                  item.classList.add('error');\n              });\n          }\n\n          if (invalidFields.length > 0) {\n            e.target.parentNode.parentNode\n              .querySelectorAll('.field-container')\n              .forEach((item) => {\n                if (invalidFields.indexOf(item.dataset.value) !== -1) {\n                  item.classList.add('error');\n                  item.querySelector('#field-error').classList.add('show');\n                }\n              });\n          }\n\n          if (errorFields.length === 0 && invalidFields.length === 0) {\n            this.sendFormReply(\n              e.target.parentNode.parentNode,\n              buttons[b].name,\n              form.id\n            );\n          }\n        };\n      } else {\n        clickAction =\n          \"chatController.sendQuickReply(this.parentNode, '\" +\n          buttons[b].name +\n          \"')\";\n      }\n\n      const buttonElem = this.createElement('button', {\n        className: 'convButton',\n        innerText: buttons[b].name,\n        onclick: clickAction,\n      });\n      responseButtonsContainer.appendChild(buttonElem);\n    }\n\n    formContainer.appendChild(responseButtonsContainer);\n    messageContainer.appendChild(formContainer);\n\n    // added timestamp\n    chatController.addTimeStamp(formContainer);\n  }\n\n  /**\n   * @description Create custom form  element\n   * @param {HTMLElement} messageContainer - container to add new elements to\n   * @param {Object} data - data of form to add\n   */\n  addCustomForm(messageContainer, data) {\n    var formId = data.values.replace('${', '').replace('}', '').split('.')[0];\n    var headers = data.headers;\n\n    const formContainer = this.createElement('form', {\n      className: 'form-container',\n      id: formId,\n    });\n\n    for (let x = 0; x < headers.length; x++) {\n      const inputElem = this.createElement('div', {\n        class: 'form-input-box-cls',\n      });\n\n      const inputLable = this.createElement('span', {\n        class: 'form-lable-cls',\n        innerText: headers[x].title,\n      });\n\n      const inputTxt = this.createElement('input', {\n        class: 'form-input-cls',\n        type: headers[x].type,\n        id: headers[x].name,\n      });\n\n      inputElem.appendChild(inputLable);\n      inputElem.appendChild(inputTxt);\n      formContainer.appendChild(inputElem);\n    }\n\n    const formConfirmBtn = this.createElement('button', {\n      className: 'form-confirm-btn',\n      innerText: 'Submit',\n      onclick: () => {\n        var formEls = this.shadowRootDoc.getElementById(formId).childNodes;\n        var jsonObj = {\n          formid: formId,\n        };\n        for (let y = 0; y < formEls.length - 1; y++) {\n          var value = formEls[y].childNodes[1].value;\n          jsonObj[formEls[y].childNodes[1].id] = value;\n        }\n        socketController.sendUserMessageToServer(\n          JSON.stringify(jsonObj),\n          false\n        );\n      },\n    });\n    formContainer.appendChild(formConfirmBtn);\n    messageContainer.appendChild(formContainer);\n\n    // added timestamp\n    chatController.addTimeStamp(formContainer);\n  }\n\n  /**\n   * @description clears unnecessary values from the response config\n   * @param {Object} config the responseConfig object returned from webOut\n   */\n  sanitizeResponseConfig(config) {\n    const cleanResConfig = {};\n    const invalidObjects = [\n      '[]',\n      '{}',\n      `{\"data\":[]}`,\n      `{\"values\":[],\"staticbuttons\":[]}`,\n    ];\n\n    Object.keys(config).forEach((property) => {\n      try {\n        if (\n          config[property] &&\n          invalidObjects.indexOf(JSON.stringify(config[property])) === -1\n        ) {\n          cleanResConfig[property] = config[property];\n        }\n      } catch {}\n    });\n\n    return cleanResConfig;\n  }\n\n  /**\n   * @description Display Message on chat\n   * @param {Boolean} isAgentMsg\n   * @param {Object} content - recieved from the server\n   * @param {Boolean} hideButtons - whether buttons should be hidden for this message or not. Only shown if it is the latest message\n   */\n  async displayMessageOnChat(isAgentMsg, content, hideButtons) {\n    const chatMessageWindow =\n      this.shadowRootDoc.querySelector('#chat-messages');\n    let doNotDisplay = false;\n\n    const messageContainer = this.createElement('div', {\n      className: isAgentMsg ? 'message-wrapper bot' : 'message-wrapper user',\n      id: 'chat-message-wrapper',\n    });\n\n    if (isAgentMsg) {\n      const messages = content.response ? content.response : null;\n\n      try {\n        if (messages && messages.length >= 0) {\n          document.getElementById('user-input').disabled = false;\n          document.getElementById('chat-input-send').disabled = false;\n          messages.forEach(function (txt, idx, messages) {\n            var tokens = messages[idx].match(\n              /\\b(?:http:\\/\\/|https:\\/\\/)(\\S+)\\b/g\n            ); // extract all url's\n\n            if (tokens) {\n              tokens.forEach(function (token, cnt, tokens) {\n                //Commenting below line of code for ticket \"LSLCUSEN-605\"\n                // don't wrap link in <a> tag if it is already wrapped in it\n                const messageBeforeUrl = messages[idx].substring(\n                  0,\n                  messages[idx].indexOf(token)\n                );\n                if (!messageBeforeUrl.endsWith('href=\"')) {\n                  messages[idx] = messages[idx].replace(\n                    token,\n                    '<a class=\"linkstyle\" href=\"' +\n                      token +\n                      '\" target=\"_blank\" rel=\"noopener noreferrer\">' +\n                      token +\n                      '</a>'\n                  ); // replace each with anchor tag\n                }\n              });\n            }\n          });\n        }\n      } catch (error) {\n        console.log(error);\n      }\n\n      content.responseConfig = this.sanitizeResponseConfig(\n        content.responseConfig || {}\n      );\n\n      const customForm =\n        content.responseConfig &&\n        content.responseConfig.customResponse &&\n        content.responseConfig.customResponse.data\n          ? JSON.parse(content.responseConfig.customResponse.data)\n          : null;\n\n      // render text message\n      if (messages) {\n        document.getElementById('user-input').disabled = false;\n        document.getElementById('chat-input-send').disabled = false;\n        this.addMessages(messageContainer, messages, content);\n      }\n\n      try {\n        if (content.responseConfig.feedbackReqMsg) {\n          this.addMessages(messageContainer, [\n            content.responseConfig.feedbackReqMsg,\n          ]);\n        }\n      } catch (e) {\n        console.log(e);\n      }\n\n      // render feedback tiles\n      if (content.responseConfig.feedbackTiles) {\n        this.addFeedbackTiles(\n          messageContainer,\n          content.responseConfig.feedbackTiles\n        );\n      }\n\n      // add carousel\n      if (content.responseConfig.carousel) {\n        document.getElementById('user-input').disabled = false;\n        document.getElementById('chat-input-send').disabled = false;\n        this.addCarousel(\n          messageContainer,\n          content.responseConfig.carousel,\n          content.responseConfig.displayUnselectedOptions,\n          hideButtons\n        );\n      }\n\n      // add datepicker\n      if (content.responseConfig.datepicker && !hideButtons) {\n        this.addDatepicker(messageContainer, content.responseConfig.datepicker);\n      }\n\n      // add form\n      if (content.responseConfig.form && !hideButtons) {\n        document.getElementById('user-input').disabled = false;\n        document.getElementById('chat-input-send').disabled = false;\n        this.addForm(\n          messageContainer,\n          content.responseConfig.form,\n          content.responseConfig.buttons\n        );\n      }\n\n      // add custom form\n      /*if (customForm && !hideButtons) {\n              this.addCustomForm(messageContainer, customForm);\n            }*/\n\n      // add buttons\n      if (\n        content.responseConfig.buttons &&\n        !content.responseConfig.form &&\n        !hideButtons\n      ) {\n        document.getElementById('user-input').disabled = false;\n        document.getElementById('chat-input-send').disabled = false;\n        this.addButtons(messageContainer, content.responseConfig.buttons);\n      }\n\n      // write logic if messages is empty, buttons is empty etc.\n      if (!messages && !content.responseConfig.buttons) {\n        doNotDisplay = true;\n      }\n    } else {\n      const messageElem = this.createElement('div', {\n        className: 'message',\n        innerText: content,\n      });\n      messageContainer.appendChild(messageElem);\n\n      // added timestamp\n      chatController.addTimeStamp(messageElem);\n    }\n\n    if (!doNotDisplay) {\n      chatMessageWindow.appendChild(messageContainer);\n    }\n  }\n\n  /**\n   * @description takes the value from a clicked button or carousel and sends message to server, as if user has typed it. After, all of the buttons are blocked\n   * @param {HTMLElement} data - the html element that has been clicked\n   */\n  sendQuickReply(node, text) {\n    // block buttons or carousel once clicked\n    if (node.classList.contains('carousel-container')) {\n      node.classList.add('not-active');\n    } else {\n      const buttonContainer = node.parentNode.childNodes;\n      buttonContainer.forEach(function (element) {\n        if (element.classList.contains('convButton')) {\n          element.disabled = true;\n        }\n      });\n    }\n    socketController.sendUserMessageToServer(text, null);\n  }\n\n  /**\n   * @description takes the value from a clicked button url\n   * @param { String } url - the button url value to be opened in a new tab\n   */\n  openButtonLink(url) {\n    window.open(url, '_blank');\n  }\n\n  /**\n   * @description removes the form component and sends form response\n   * @param {HTMLElement} node - the form element\n   * @param text - response message\n   */\n  sendFormReply(node, text, key) {\n    node.parentNode.removeChild(node);\n    socketController.sendUserMessageToServer(text, {\n      data: this.activeForm,\n      key: key,\n    });\n    this.activeForm = {};\n  }\n\n  /**\n   * @description Clears the chat window of messages\n   */\n  clearMessages() {\n    const chatMessageWindow =\n      this.shadowRootDoc.querySelector('#chat-messages');\n    chatMessageWindow.innerHTML = '';\n  }\n\n  fetchChatbotName() {\n    if (window && window.chatSettings && window.chatSettings.chatbotName) {\n      return window.chatSettings.chatbotName;\n    } else {\n      return 'Edwin';\n    }\n  }\n\n  /**\n   * @description hides the button responsible for opening chat window and shows the chat window\n   */\n  openChatWindow() {\n    this.shadowRootDoc.querySelector('#open-converse').className = 'hide';\n    this.shadowRootDoc.querySelector('#chat-window').className = 'show';\n  }\n\n  /**\n   * @description responsible for opening the chat window and initialising a new socket connection/chat session if one does not already exist\n   */\n  openConverse() {\n    this.shadowRootDoc = document.getElementById('chat-bot'); // change to element.shadowRoot to actually use shadow DOM\n    // initialise socket connection if it hasnt already been done\n    if (!socketController.socket) {\n      socketController.initSocket();\n    }\n    this.openChatWindow();\n  }\n\n  /**\n   * @description responsible for maximising the chat window\n   */\n  maximizeChat() {\n    const chatState =\n      this.shadowRootDoc.querySelector('#chat-window').className;\n    if (chatState === 'maximize') {\n      this.shadowRootDoc.querySelector('#chat-window').className = 'show';\n      this.shadowRootDoc.querySelector('#chat-resize-btn').className =\n        'chat-header-btn  maximize_chat_window';\n      this.shadowRootDoc.querySelector('#chat-messages').className = 'minimize';\n      this.shadowRootDoc.querySelector(\n        '.user-interaction-bar-maximize'\n      ).className = 'user-interaction-bar';\n    } else {\n      this.shadowRootDoc.querySelector('#chat-window').className = 'maximize';\n      this.shadowRootDoc.querySelector('#chat-messages').className = 'maximize';\n      this.shadowRootDoc.querySelector('.user-interaction-bar').className =\n        'user-interaction-bar-maximize';\n      this.shadowRootDoc.querySelector(\n        '.user-interaction-bar-maximize'\n      ).style.width = '97%';\n      this.shadowRootDoc.querySelector(\n        '.user-interaction-bar-maximize'\n      ).style.margin = '10px auto';\n      this.shadowRootDoc.querySelector(\n        '.user-interaction-bar-maximize'\n      ).style.height = '50px';\n    }\n  }\n\n  /**\n   * @description responsible for creating the html for the chat window - this uses the Shadow DOM approach\n   */\n  initChatWindow() {\n    const chatbot = this.createElement('div', {id: 'chat-bot'});\n    chatbot.style.position = 'fixed';\n    document.body.appendChild(chatbot);\n    const shadowRoot = chatbot; // add .attachShadow({ mode: \"open\" }); to reapply shaddow DOM\n    const chatWindow = this.createElement('div', {\n      id: 'chat-window',\n    });\n    // Datepicker styling gives warning in the browser console\n    const assetsCss = this.createElement('link', {\n      rel: 'stylesheet',\n      href: window.chatSettings.assetsBasePath\n        ? window.chatSettings.assetsBasePath + 'dist/css/assets.css'\n        : 'dist/css/assets.css',\n    });\n    const styleLink = this.createElement('link', {\n      id: 'chatbotStyleLink',\n      rel: 'stylesheet',\n      href: window.chatSettings.assetsBasePath\n        ? window.chatSettings.assetsBasePath +\n          'dist/css/' +\n          window.chatSettings.theme\n        : 'dist/css/defaultChatbot.css',\n    });\n    const chatHeader = this.createElement('div', {\n      className: 'chat-header',\n    });\n    const headerLabel = this.createElement('div', {\n      className: 'chat-header-label bot',\n      innerText: this.fetchChatbotName(),\n      id: 'header-label',\n    });\n\n    const reloadBtn = this.createElement('div', {\n      className: 'chat-header-btn reload',\n      id: 'reload-btn',\n      onclick:\n        'socketController.resetConversation({ resetButtonClicked: true, keepChatMsgs: false })',\n    });\n    chatWindow.style.borderRadius = 0;\n    chatHeader.style.borderRadius = 0;\n    reloadBtn.style.right = '15px';\n    chatHeader.appendChild(headerLabel);\n    chatHeader.appendChild(reloadBtn);\n\n    const chatMessageWindow = this.createElement('div', {\n      id: 'chat-messages',\n    });\n\n    this.typingIndicator = this.createElement('div', {\n      id: 'typing-indicator',\n    });\n    const dot1 = this.createElement('span');\n    const dot2 = this.createElement('span');\n    const dot3 = this.createElement('span');\n    this.typingIndicator.appendChild(dot1);\n    this.typingIndicator.appendChild(dot2);\n    this.typingIndicator.appendChild(dot3);\n\n    const userInteractionWrapper = this.createElement('form', {\n      className: 'user-interaction-bar',\n      onsubmit: (e) => {\n        e.preventDefault();\n        if (chatController.datePicker) {\n          chatController.datePicker.close();\n          var elements = document.querySelectorAll(\n            '.' + chatController.dateClass\n          );\n          for (var element of elements) {\n            element.remove(); // or // element.parentNode.removeChild(element);}\n          }\n        }\n        socketController.sendUserMessageToServer('', null);\n      },\n    });\n    const voiceBtn = this.createElement('div', {\n      className: 'chat-input-btn voice voice-input-btn',\n      id: 'voice-toggle',\n      onclick: 'chatController.toggleVoice()',\n    });\n    voiceBtn.style.display = 'none';\n\n    const userInputField = this.createElement('input', {\n      className: 'user-input-textbox',\n      id: 'user-input',\n      autocomplete: 'off',\n    });\n    const submitUserMessageButton = this.createElement('button', {\n      className: 'btn-chat-send',\n      id: 'chat-input-send',\n      innerHTML: 'Send',\n    });\n    submitUserMessageButton.style.border = 'none';\n    userInputField.setAttribute('placeholder', 'Nachricht eingeben...');\n    if (window && window.chatSettings && window.chatSettings.voiceEnabled) {\n      userInteractionWrapper.appendChild(voiceBtn);\n    }\n    userInteractionWrapper.appendChild(userInputField);\n    userInteractionWrapper.appendChild(submitUserMessageButton);\n    const openConverseButton = this.createElement('div', {\n      id: 'open-converse',\n      onclick: 'chatController.openConverse()',\n    });\n\n    // finalise the chat window elements\n    chatWindow.appendChild(chatHeader);\n    chatWindow.appendChild(chatMessageWindow);\n    chatWindow.appendChild(userInteractionWrapper);\n    // add all elements to the shadow root\n    shadowRoot.appendChild(openConverseButton);\n    shadowRoot.appendChild(chatWindow);\n    shadowRoot.appendChild(assetsCss);\n    shadowRoot.appendChild(styleLink);\n\n    // shadow root doc is used elsewhere in the code to query Shadow Root DOM\n    this.shadowRootDoc = chatbot; // change to chatbot.shadowRoot to actually use shadow DOM\n  }\n\n  /**\n   * @description displays error message\n   */\n  showErrorMessage(message) {\n    const chatWindow = this.shadowRootDoc.querySelector('#chat-window');\n    const existingError = this.shadowRootDoc.querySelector('#error-overlay');\n\n    if (!existingError) {\n      const errorOverlay = this.createElement('div', {\n        className: 'error-overlay',\n        id: 'error-overlay',\n      });\n      const errorMessage = this.createElement('div', {\n        className: 'error-message',\n        innerText: message,\n        onclick: 'chatController.hideErrorMessage()',\n      });\n      errorOverlay.appendChild(errorMessage);\n      chatWindow.appendChild(errorOverlay);\n    }\n  }\n\n  /**\n   * @description adds text as the user input\n   * @param text - input message\n   */\n  setInput(text) {\n    document.getElementById('user-input').value = text;\n  }\n\n  /**\n   * @description removes error message\n   */\n  hideErrorMessage() {\n    const chatWindow = this.shadowRootDoc.querySelector('#chat-window');\n    const errorOverlay = this.shadowRootDoc.querySelector('#error-overlay');\n    if (errorOverlay) {\n      chatWindow.removeChild(errorOverlay);\n    }\n  }\n\n  handleIncomingMessage(message) {\n    // Prevent duplicate welcome message, we only get response if user ask\n    const messages = document.querySelector('#chat-messages');\n    if (\n      messages &&\n      messages.children.length > 0 &&\n      messages.lastChild.classList.contains('bot')\n    ) {\n      return;\n    }\n    this.hideTypingIndicator();\n\n    this.agentAvailable = message.agentAvailable;\n\n    if (this.agentAvailable) {\n      this.agentName = message.converseResponse.agentName\n        ? message.converseResponse.agentName\n        : this.fetchChatbotName();\n      this.shadowRootDoc.querySelector('#header-label').innerText =\n        this.agentName;\n      this.shadowRootDoc.querySelector('#chat-sidebar-name').innerText =\n        this.agentName;\n    }\n\n    this.displayMessageOnChat(true, message.converseResponse);\n    // scroll to bottom whenever receiving a message\n    this.scrollToBottom();\n\n    if (this.voiceEnabled) {\n      const isSSMLMsg = message.converseResponse.responseSsml;\n      const botResponse = isSSMLMsg\n        ? isSSMLMsg\n        : message.converseResponse.response;\n      chatController.sendTTSMessage(botResponse);\n    }\n  }\n\n  /**\n   * @description added timestamp function responsible for showing the timestamp on the bot-messages\n   * @param messageContainer - container to add new elements to\n   * @param sessionTime - used in the condition for adding timestamp\n   */\n  addTimeStamp(messageContainer, sessionTime) {\n    let time = new Date();\n    let seconds = time.getSeconds();\n    let localTime = time.toLocaleString('en-US', {\n      hour: 'numeric',\n      minute: 'numeric',\n      hour12: false,\n    });\n    socketController.addTimeToSession(localTime);\n    if (seconds >= 1 && seconds <= 59 && !sessionTime) {\n      const timeStamp = this.createElement('div', {\n        className: 'bot-timeStamp ' + localTime,\n        id: 'bot-timeStamp-id',\n        innerHTML: 'vor wenigen Sekunden',\n      });\n      messageContainer.appendChild(timeStamp);\n    } else if (!sessionTime) {\n      const timeStamp = this.createElement('div', {\n        className: 'bot-timeStamp',\n        id: 'bot-timeStamp-id',\n        innerHTML: localTime,\n      });\n      messageContainer.appendChild(timeStamp);\n    }\n    setTimeout(function () {\n      var botTimeStampClass = document.getElementsByClassName('bot-timeStamp');\n      for (let i = 0; i < botTimeStampClass.length; i++) {\n        if (botTimeStampClass[i].innerHTML === 'vor wenigen Sekunden') {\n          var botClassName = botTimeStampClass[i].className.split(' ');\n          botTimeStampClass[i].innerHTML = botClassName[1]; // + ' ' + botClassName[2];\n        }\n      }\n    }, 1000 * 59);\n  }\n\n  getLastResponse() {\n    const messages =\n      this.shadowRootDoc.querySelector('#chat-messages').children;\n\n    let manageResponses = [];\n    if (messages.length > 0) {\n      // Count backwards to look for last bot messages\n      for (let i = messages.length - 1; i >= 0; i--) {\n        if (messages.item(i).className === 'message-wrapper bot') {\n          if (messages.item(i).getAttribute('data-ssml')) {\n            manageResponses.unshift(messages.item(i).getAttribute('data-ssml'));\n          } else {\n            manageResponses.unshift(messages.item(i).innerText);\n          }\n        } else {\n          // Return only last bot responses after last user message\n          break;\n        }\n      }\n    }\n\n    const lastResponse = manageResponses.join(' ');\n    const messageWithoutTimestamp = RemoveTimeStamp();\n    return messageWithoutTimestamp;\n\n    /**\n     * @description function to remove the timestamp from the message\n     * @param {Array<String>} lastResponse - string containing bot message\n     */\n    function RemoveTimeStamp() {\n      const responseTime = lastResponse.replace(\n        /((1[0-2]|0?[1-9]):([0-5][0-9]) ([AaPp][Mm]))/gi,\n        ' '\n      );\n      const responseSeconds = responseTime.replace(\n        /(vor wenigen Sekunden)/gi,\n        ' '\n      );\n      return responseSeconds;\n    }\n  }\n\n  changeLivePerson() {\n    const label = this.agentAvailable\n      ? this.agentName\n      : this.fetchChatbotName();\n    this.shadowRootDoc.querySelector('#header-label').innerText = label;\n    if (this.agentAvailable) {\n      this.shadowRootDoc.querySelector('#chat-sidebar').classList.remove('bot');\n      this.shadowRootDoc.querySelector('#chat-sidebar').classList.add('lp');\n      this.shadowRootDoc.querySelector('#chat-sidebar-name').innerText =\n        'Live Person';\n\n      this.shadowRootDoc\n        .querySelector('#chat-sidebar-image')\n        .classList.remove('bot');\n      this.shadowRootDoc\n        .querySelector('#chat-sidebar-image')\n        .classList.add('lp');\n    } else {\n      this.shadowRootDoc.querySelector('#chat-sidebar').classList.remove('lp');\n      this.shadowRootDoc.querySelector('#chat-sidebar').classList.add('bot');\n      this.shadowRootDoc.querySelector('#chat-sidebar-name').innerText =\n        this.fetchChatbotName();\n\n      this.shadowRootDoc\n        .querySelector('#chat-sidebar-image')\n        .classList.remove('lp');\n      this.shadowRootDoc\n        .querySelector('#chat-sidebar-image')\n        .classList.add('bot');\n    }\n  }\n}\n\nconst chatController = new ChatController();\n"]}